<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>scan test</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/quagga/0.12.1/quagga.min.js" ></script>
    <style type="text/css">
      .my_result video{
        width: 100vw;
        height: 99vh;
        object-fit: cover;
      }
      .my_result canvas {
        position: absolute;
        z-index: 1000;
        right: 0;
        width: 100%;
    }
}
    </style>
    <script>
        function qinit(){
            Quagga.init({
                inputStream : {
                        name : "Live",
                        type : "LiveStream",
                        constraints: {
                        facingMode: 'environment'
                    },
                        area: {
                        top: '33%',
                        left: '33%',
                        bottom: '33%',
                        right: '33%'
                    },
                        target: document.querySelector('#my_result')
                    },
                    decoder : {
                        readers : ['code_128_reader'],
                        debug: {
                        drawBoundingBox: true,
                        drawScanline: true,
                        showPattern: true
                    }
                    },
                    locate: false
                }, function(err) {
                    if (err) {
                        console.dir(err);
                        alert('error of init camera')
                        return
                    }
                    console.log("Initialization finished. Ready to start");
                    Quagga.start();
                    document.getElementById('my_result').setAttribute("style","position:absolute;top:0;left:0;");
 
                    Quagga.onDetected(function(result){
                        console.log(result)
                        alert(result.codeResult.code);
                    })
 
            })
        }
        function qstop(){
            Quagga.stop();
        }

    </script>
</head>
<body>
    <div id = "my_result" class="my_result">
    </div>
    <div>
        <button onclick="qinit()">开始扫描</button>
        <button onclick="qstop()">停止扫描</button>
    </div>
</body>
</html>
